!function(e){"function"==typeof define&&define.amd?define("appEvents",e):e()}(function(){"use strict";jQuery(e=>{var t=document.getElementById("vx-app-events");t&&(window.$=jQuery,(e=>{let t=JSON.parse(e.dataset.config);return Vue.createApp({el:e,data(){return{config:t,state:{loading:!1,activeEvent:null,activeCategory:Object.keys(t.categories)[0]}}},created(){Object.values(this.config.events).forEach(e=>{e.activeNotification=Object.values(e.notifications)[0]});var e=Voxel_Backend.getSearchParam("tab")||Object.keys(this.config.categories)[0];this.config.categories[e]&&this.toggleCategory(this.config.categories[e])},methods:{toggleEvent(e){this.state.activeEvent=this.state.activeEvent===e?null:e},saveChanges(){this.state.loading=!0;let i={};Object.values(this.config.events).forEach(a=>{i[a.key]={notifications:{}},Object.keys(a.notifications).forEach(e=>{var t=a.notifications[e];i[a.key].notifications[e]={inapp:t.inapp,email:t.email}})});var e=Voxel_Config.ajax_url+"&action=app_events.save_config";jQuery.post(e,{config:JSON.stringify(i)},e=>{this.state.loading=!1,e.success?Voxel_Backend.alert(e.message,"info",2e3):Voxel_Backend.alert(e.message||Voxel_Config.l10n.ajaxError,"error")})},editTags(e,t,a,i=null){var n=a.split(".");let o=n[0],s=n[1];void 0===t[o][s]?console.log("Unknown target: "+a):Voxel_Dynamic.edit(t[o][s]||i,{groups:e.dynamic_tags,onSave:e=>{t[o][s]=e===i?"":e}})},toggleCategory(e){this.state.activeCategory=e.key;var t=new URL(window.location);t.searchParams.set("tab",e.key),window.history.replaceState(null,null,t)},categoryHasEvents(t){return Object.values(this.config.events).some(e=>e.category===t.key)}}})})(t).mount("#vx-app-events"))})});
