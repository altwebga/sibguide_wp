!function(e){"function"==typeof define&&define.amd?define("createPost",e):e()}(function(){"use strict";var a={template:"#create-post-media-popup",props:{multiple:{type:Boolean,default:!0},ignore:{type:Array,default:[]},customTarget:[Object,String],saveLabel:String},emits:["save","blur","open"],data(){return{files:[],selected:{},active:!1,loading:!0,has_more:!1,firstLoad:!0,search:{term:"",offset:0,loading:!1,loading_more:!1,has_more:!1,list:null}}},methods:{getStyle(e){return e.type.startsWith("image/")?`background-image: url('${e.preview}');`:""},selectFile(e){this.selected[e.id]?delete this.selected[e.id]:(this.multiple||(this.selected={}),this.selected[e.id]=e)},selectSessionFile(e){this.selected[e._id]?delete this.selected[e._id]:(this.multiple||(this.selected={}),this.selected[e._id]=e)},loadMedia(){jQuery.get(Voxel_Config.ajax_url+"&action=list_media",{offset:this.files.length}).always(e=>{this.loading=!1,e.success?(this.files.push(...e.data),this.has_more=e.has_more):Voxel.alert(e.message||Voxel_Config.l10n.ajaxError,"error")})},loadMore(){this.loading=!0,this.loadMedia()},openLibrary(){this.$emit("open"),this.firstLoad&&this.loadMedia(),this.firstLoad=!1,this.active=!this.active},isImage(e){return e.type.startsWith("image/")},save(){this.active=!1,this.$emit("save",this.selected),this.selected={}},clear(){this.selected={}},clientSearchFiles(){let t=this.search.term.trim().toLowerCase(),i=[],s=!1;this.files.forEach(e=>{s||-1!==e.name.toLowerCase().indexOf(t)&&(i.push(e),s=10<=i.length)}),this.search.list=i,this.search.loading=!1,this.search.has_more=!1,this.search.loading_more=!1},serverSearchFiles:Voxel.helpers.debounce((t,i=!1)=>{jQuery.get(Voxel_Config.ajax_url+"&action=list_media",{offset:i?t.search.list.length:0,search:t.search.term.trim()}).always(e=>{t.search.loading=!1,t.search.loading_more=!1,e.success?(i?t.search.list.push(...e.data):t.search.list=e.data,t.search.has_more=e.has_more):Voxel.alert(e.message||Voxel_Config.l10n.ajaxError,"error")})}),sessionFiles(){return Array.isArray(window._vx_file_upload_cache)||(window._vx_file_upload_cache=[]),window._vx_file_upload_cache.reverse()}},watch:{"search.term"(){this.search.term.trim()&&this.files&&(this.search.loading=!0,!this.has_more||this.search.term.trim().length<=2?this.clientSearchFiles():this.serverSearchFiles(this))}}},r={template:"#create-post-title-field",props:{field:Object},methods:{validate(e){var t,i,s,a;this.$root.shouldValidate()&&(t=[],i=!("string"==typeof e&&1<=e.trim().length),s=this.field.props.minlength,a=this.field.props.maxlength,this.$root.shouldValidateRequired()&&this.field.required&&i&&t.push(this.$root.get_error("required")),i||(s&&e.length<s&&t.push(this.$root.replace_vars(this.$root.get_error("text:minlength"),{"@minlength":s})),a&&e.length>a&&t.push(this.$root.replace_vars(this.$root.get_error("text:maxlength"),{"@maxlength":a}))),this.field.validation.errors=t)}},watch:{"field.value"(){this.validate(this.field.value)}}},l={template:"#create-post-text-field",props:{field:Object},methods:{validate(e){var t,i,s,a;this.$root.shouldValidate()&&(t=[],i=!("string"==typeof e&&1<=e.trim().length),s=this.field.props.minlength,a=this.field.props.maxlength,this.$root.shouldValidateRequired()&&this.field.required&&i&&t.push(this.$root.get_error("required")),i||(s&&e.length<s&&t.push(this.$root.replace_vars(this.$root.get_error("text:minlength"),{"@minlength":s})),a&&e.length>a&&t.push(this.$root.replace_vars(this.$root.get_error("text:maxlength"),{"@maxlength":a}))),this.field.validation.errors=t)}},watch:{"field.value"(){this.validate(this.field.value)}}},o={template:"#create-post-texteditor-field",props:{field:Object,index:{type:Number,default:0}},data(){return{editor:{id:this.field.props.editorId,config:JSON.parse(JSON.stringify(this.field.props.editorConfig))}}},created(){this.field.in_repeater&&"plain-text"!==this.field.props.editorType&&(this.editor.id+=this.index,this.editor.config.textarea_name+=this.index),"plain-text"!==this.field.props.editorType&&"string"==typeof this.field.value&&(this.field.value=this.field.value.replaceAll("\x3c!--_more--\x3e","\x3c!--more--\x3e"))},mounted(){this.renderEditor()},unmounted(){wp.oldEditor?.remove(this.editor.id)},methods:{renderEditor(){"plain-text"!==this.field.props.editorType&&this.field.step===this.$root.currentStep.key&&(this.$refs.editor.innerHTML=this.field.value,jQuery(()=>{wp.oldEditor.remove(this.editor.id),wp.oldEditor.initialize(this.editor.id,this.editor.config);let e=tinyMCE.editors[this.editor.id];e.on("change",e=>this.field.value=e.target.getContent()),e.on("keyup",()=>e.save()),e.on("input",()=>e.save())})),"plain-text"===this.field.props.editorType&&this.$nextTick(()=>this.resizeComposer())},resizeComposer(){this.$refs.composer&&(this.$refs._composer.value=this.$refs.composer.value,this.$refs._composer.style.width=this.$refs.composer.scrollWidth+"px",this.$refs._composer.style.minWidth=this.$refs.composer.scrollWidth+"px",this.$refs._composer.style.maxWidth=this.$refs.composer.scrollWidth+"px",this.$refs.composer.style.height=this.$refs._composer.scrollHeight+"px")},validate(t){if(this.$root.shouldValidate()){var i=[],s=!("string"==typeof t&&1<=t.trim().length),a=this.field.props.minlength,r=this.field.props.maxlength,l="plain-text"===this.field.props.editorType;if(this.$root.shouldValidateRequired()&&this.field.required&&s&&i.push(this.$root.get_error("required")),!s){let e=t;l||((s=document.createElement("div")).innerHTML=t,e=s.innerText,s.remove()),a&&e.length<a&&i.push(this.$root.replace_vars(this.$root.get_error("text:minlength"),{"@minlength":a})),r&&e.length>r&&i.push(e.length+"/"+r)}this.field.validation.errors=i}}},computed:{content_length(){let e=this.field.value;var t;return"string"!=typeof e?0:("plain-text"!==this.field.props.editorType&&((t=document.createElement("div")).innerHTML=e,e=t.innerText,t.remove()),e.length)}},watch:{"$root.currentStep"(){this.renderEditor()},"field.value"(){this.validate(this.field.value)}}},d={template:"#create-post-texteditor-field",extends:o},n={template:"#create-post-number-field",props:{field:Object},created(){var e=parseFloat(this.field.value);isNaN(e)||(this.field.value=e)},methods:{increment(){var e,t;"number"!=typeof this.field.value?(e="number"==typeof this.field.props.min?this.field.props.min:0,t="number"==typeof this.field.props.step?this.field.props.step:1,this.setValue(0===e?t:e)):this.setValue(this.field.value+this.field.props.step)},decrement(){"number"!=typeof this.field.value?this.setValue(this.field.props.min):this.setValue(this.field.value-this.field.props.step)},setValue(e){""===e||"number"!=typeof e?this.field.value=null:e<this.field.props.min?this.field.value=this.field.props.min:e>this.field.props.max?this.field.value=this.field.props.max:this.field.value=Number(e.toFixed(this.field.props.precision))},validate(e){var t,i,s,a;this.$root.shouldValidate()&&(t=[],i=!("number"==typeof e),s=this.field.props.min,a=this.field.props.max,this.$root.shouldValidateRequired()&&this.field.required&&i&&t.push(this.$root.get_error("required")),i||(s&&e<s&&t.push(this.$root.replace_vars(this.$root.get_error("number:min"),{"@min":s})),a&&a<e&&t.push(this.$root.replace_vars(this.$root.get_error("number:max"),{"@max":a}))),this.field.validation.errors=t)}},watch:{"field.value"(){this.validate(this.field.value)}}},h={template:"#create-post-email-field",props:{field:Object},methods:{validate(e){var t,i;this.$root.shouldValidate()&&(t=[],i=!("string"==typeof e&&1<=e.trim().length),this.$root.shouldValidateRequired()&&this.field.required&&i&&t.push(this.$root.get_error("required")),i||/^\S+@\S+\.\S+$/.test(e)||t.push(this.$root.get_error("email:invalid")),this.field.validation.errors=t)}},watch:{"field.value"(){this.validate(this.field.value)}}},u={template:"#create-post-url-field",props:{field:Object},methods:{validate(t){if(this.$root.shouldValidate()){var i=[],e=!("string"==typeof t&&1<=t.trim().length);if(this.$root.shouldValidateRequired()&&this.field.required&&e&&i.push(this.$root.get_error("required")),!e){let e=t;1<=e.indexOf(".")&&!e.startsWith("http://")&&!e.startsWith("https://")&&(e="https://"+e);try{new URL(e)}catch(e){i.push(this.$root.get_error("url:invalid"))}}this.field.validation.errors=i}}},watch:{"field.value"(){this.validate(this.field.value)}}},c={template:"#create-post-file-field",props:{field:Object,mediaTarget:[Object,String],index:{type:Number,default:null},sortable:{type:Boolean,default:!0},showLibrary:{type:Boolean,default:!0},previewImages:{type:Boolean,default:!0}},data(){return{accepts:"",dragActive:!1,reordering:!1}},created(){null===this.field.value&&(this.field.value=[]),this.field.props.allowedTypes&&(this.accepts=Object.values(this.field.props.allowedTypes).join(", ")),this.$watch(()=>this.field.value,()=>{this.validate(this.field.value)},{deep:!0})},mounted(){jQuery(this.$refs.input).on("change",e=>{for(var t=0;t<e.target.files.length;t++){var i=e.target.files[t];this.pushFile(i)}this.$refs.input.value="",this.$emit("files-added")})},unmounted(){setTimeout(()=>{Object.values(this.field.value).forEach(e=>{"new_upload"===e.source&&URL.revokeObjectURL(e.preview)})},10)},methods:{getStyle(e){return e.type.startsWith("image/")&&this.previewImages?`background-image: url('${e.preview}');`:""},pushFile(t){1===this.field.props.maxCount&&(this.field.value=[]);var e={source:"new_upload",name:t.name,type:t.type,size:t.size,preview:URL.createObjectURL(t),item:t,_id:Voxel.helpers.randomId(8)},i=(void 0===window._vx_file_upload_cache&&(window._vx_file_upload_cache=[]),window._vx_file_upload_cache.find(e=>e.item.name===t.name&&e.item.type===t.type&&e.item.size===t.size&&e.item.lastModified===t.lastModified));i?this.field.value.push(i):(this.field.value.push(e),window._vx_file_upload_cache.unshift(e))},onDrop(e){this.dragActive=!1,e.dataTransfer.items?[...e.dataTransfer.items].forEach(e=>{"file"===e.kind&&this.pushFile(e.getAsFile())}):[...e.dataTransfer.files].forEach(e=>{this.pushFile(e)}),this.$emit("files-added")},onMediaPopupSave(e){1===this.field.props.maxCount&&(this.field.value=[]);var t={};this.field.value.forEach(e=>{"existing"===e.source&&(t[e.id]=!0),"new_upload"===e.source&&(t[e._id]=!0)}),Object.values(e).forEach(e=>{"existing"!==e.source||t[e.id]||this.field.value.push(e),"new_upload"!==e.source||t[e._id]||this.field.value.push(e)}),this.$emit("files-added")},onSubmit(t,i,e=null){var s;s=null!==e?`files[${this.field.id}::row-${e}][]`:`files[${this.field.id}][]`,t[this.field.key]=[],this.field.value.forEach(e=>{"new_upload"===e.source?(i.append(s,e.item),t[this.field.key].push("uploaded_file")):"existing"===e.source&&t[this.field.key].push(e.id)})},validate(e){if(this.$root.shouldValidate()){let t=[];var a=!(Array.isArray(e)&&1<=e.length),r=this.field.props.maxCount;let i=this.field.props.maxSize,s=this.field.props.allowedTypes;this.$root.shouldValidateRequired()&&this.field.required&&a&&t.push(this.$root.get_error("required")),a||(r&&e.length>r&&t.push(this.$root.replace_vars(this.$root.get_error("file:max"),{"@max":r})),i&&e.forEach(e=>{"new_upload"===e.source&&e.size>1e3*i&&t.push(this.$root.replace_vars(this.$root.get_error("file:size"),{"@filename":e.name,"@limit_kb":i,"@limit_mb":i/1e3}))}),Array.isArray(s)&&s.length&&e.forEach(e=>{s.includes(e.type)||t.push(this.$root.replace_vars(this.$root.get_error("file:type"),{"@filename":e.name,"@filetype":e.type}))})),this.field.validation.errors=t}}}},f={template:"#create-post-phone-field",props:{field:Object},methods:{validate(e){var t;this.$root.shouldValidate()&&(t=[],e=!("string"==typeof e&&1<=e.trim().length),this.$root.shouldValidateRequired()&&this.field.required&&e&&t.push(this.$root.get_error("required")),this.field.validation.errors=t)}},watch:{"field.value"(){this.validate(this.field.value)}}},m={template:"#create-post-switcher-field",props:{field:Object,index:{type:Number,default:0}},data(){return{switcherId:`_switch-${this.field.id}:`+this.index}},methods:{validate(e){var t;this.$root.shouldValidate()&&(t=[],e=!(!0===e),this.$root.shouldValidateRequired()&&this.field.required&&e&&t.push(this.$root.get_error("required")),this.field.validation.errors=t)}},watch:{"field.value"(){this.validate(this.field.value)}}},v={template:"#create-post-location-field",props:{field:Object},data(){return{map:null}},mounted(){Voxel.Maps.await(()=>{new Voxel.Maps.Autocomplete(this.$refs.addressInput,e=>{e?(this.field.value.address=e.address,this.field.value.latitude=e.latlng.getLatitude(),this.field.value.longitude=e.latlng.getLongitude(),this.map&&this.map.fitBounds(e.viewport)):this.field.value.address=this.$refs.addressInput.value},this.$root.config.autocomplete),this.field.value.map_picker&&this.$nextTick(()=>this.setupMap())})},methods:{setupMap(){this.map||Voxel.Maps.await(()=>{this.map=new Voxel.Maps.Map({el:this.$refs.mapDiv,zoom:this.field.props.default_zoom}),this.marker=new Voxel.Maps.Marker({template:this.$refs.marker.innerHTML});var e=this.getMarkerPosition();e&&(this.map.setCenter(e),this.marker.setPosition(e),this.marker.setMap(this.map)),this.map.addListener("click",e=>{e=this.map.getClickPosition(e);this.marker.getPosition()||(this.marker.setPosition(e),this.marker.setMap(this.map)),this.field.value.latitude=e.getLatitude(),this.field.value.longitude=e.getLongitude(),Voxel.Maps.getGeocoder().geocode(e.toGeocoderFormat(),e=>{this.field.value.address=e.address})})})},getMarkerPosition(){return"number"!=typeof this.field.value.latitude||"number"!=typeof this.field.value.longitude?null:new Voxel.Maps.LatLng(this.field.value.latitude,this.field.value.longitude)},geolocate(){Voxel.Maps.getGeocoder().getUserLocation({fetchAddress:!0,receivedPosition:e=>{this.field.value.latitude=e.getLatitude(),this.field.value.longitude=e.getLongitude()},receivedAddress:e=>{this.field.value.address=e.address,this.map&&this.map.fitBounds(e.viewport)},positionFail:()=>Voxel.alert(Voxel_Config.l10n.positionFail,"error"),addressFail:()=>Voxel.alert(Voxel_Config.l10n.addressFail,"error")})},validate(e){var t,i;this.$root.shouldValidate()&&(t=[],i=!("object"==typeof e&&"string"==typeof e.address&&1<=e.address.length&&"number"==typeof e.latitude&&"number"==typeof e.longitude),this.$root.shouldValidateRequired()&&this.field.required&&i&&t.push(this.$root.get_error("required")),!i&&((e.latitude<-90||90<e.latitude)&&t.push(this.$root.get_error("location:invalid_position")),e.longitude<-180||180<e.longitude)&&t.push(this.$root.get_error("location:invalid_position")),this.field.validation.errors=t)}},watch:{"field.value.address"(){this.validate(this.field.value)},"field.value.map_picker"(){this.$nextTick(()=>this.setupMap())},"field.value.latitude"(){this.marker?.setPosition(this.getMarkerPosition()),this.validate(this.field.value)},"field.value.longitude"(){this.marker?.setPosition(this.getMarkerPosition()),this.validate(this.field.value)}}},g={template:"#create-post-work-hours-field",props:{field:Object},data(){return{}},methods:{addGroup(){this.field.value.push({days:[],status:"hours",hours:[]})},removeGroup(e){this.field.value.splice(this.field.value.indexOf(e),1)},removeHours(e,t){t.hours.splice(t.hours.indexOf(e),1)},addHours(e){e.hours.push({from:"09:00",to:"17:00"})},displayDays(e){return e.map(e=>this.field.props.weekdays[e]).filter(Boolean).join(", ")},displayTime(e){return new Date("2021-01-01 "+e).toLocaleTimeString().replace(/([\d]+:[\d]{2})(:[\d]{2})(.*)/,"$1$3")},id(){return this.field.id+"."+Object.values(arguments).join(".")},isChecked(e,t){return t.includes(e)},check(e,t){t.includes(e)?t.splice(t.indexOf(e),1):t.push(e)},isDayAvailable(e,t){return t.days.includes(e)||this.unusedDays.includes(e)},validate(t){if(this.$root.shouldValidate()){var i=[];let e=!0;if(Array.isArray(t))e:for(var s of t)if(s.days.length){if("open"===s.status||"closed"===s.status||"appointments_only"===s.status){e=!1;break}if("hours"===s.status&&s.hours.length)for(var a of s.hours)if("string"==typeof a.from&&a.from.length&&"string"==typeof a.to&&a.to.length){e=!1;break e}}this.$root.shouldValidateRequired()&&this.field.required&&e&&i.push(this.$root.get_error("required")),this.field.validation.errors=i}}},computed:{unusedDays(){var t=[];return this.field.value.forEach(e=>t=t.concat(e.days)),Object.keys(this.field.props.weekdays).filter(e=>!t.includes(e))}}};const y={template:"#create-post-term-list",props:["terms","parent-term","previous-list","list-key"],data(){return{taxonomyField:Voxel.helpers.getParent(this,"taxonomy-field"),perPage:50,page:1}},methods:{selectTerm(e){e.children&&e.children.length?(this.taxonomyField.slide_from="right",this.taxonomyField.active_list="terms_"+e.id):this.taxonomyField.selectTerm(e)},goBack(){this.taxonomyField.slide_from="left",this.taxonomyField.active_list=this.previousList},afterEnter(e,t){setTimeout(()=>e.closest(".min-scroll").scrollTop=this.taxonomyField.scrollPosition[t]||0,100)},beforeLeave(e,t){this.taxonomyField.scrollPosition[t]=e.closest(".min-scroll").scrollTop}},computed:{termsWithChildren(){return this.terms.filter(e=>e.children&&e.children.length)}}};var b={template:"#create-post-taxonomy-field",name:"taxonomy-field",props:{field:Object,index:{type:Number,default:0}},data(){return{value:{},terms:this.field.props.terms,active_list:"toplevel",slide_from:"right",search:"",displayValue:"",scrollPosition:{},termCount:0}},created(){this.value=this.field.props.selected,this.displayValue=this._getDisplayValue();let i=(t,e)=>{this.termCount++,t.parentRef=e,t.children&&t.children.forEach(e=>i(e,t))};this.terms.forEach(e=>i(e,null))},methods:{saveValue(){this.field.value=this.isFilled()?Object.keys(this.value):null,this.displayValue=this._getDisplayValue()},onSave(){this.saveValue(),this.$refs.formGroup.$refs.popup.$emit("blur")},onClear(){this.value={},this.search="",this.$refs.searchInput?.focus()},isFilled(){return Object.keys(this.value).length},_getDisplayValue(){return Object.values(this.value).map(e=>e.label).join(", ")},deselectChildren(e){e.children&&e.children.forEach(e=>{delete this.value[e.slug],this.deselectChildren(e)})},selectTerm(t){if(this.value[t.slug]){delete this.value[t.slug],this.deselectChildren(t);let e=t.parentRef;for(;e;)e.children.some(e=>!!this.value[e.slug])||delete this.value[e.slug],e=e.parentRef}else{this.field.props.multiple||Object.keys(this.value).forEach(e=>delete this.value[e]);let e=(this.value[t.slug]=t).parentRef;for(;e;)e=(this.value[e.slug]=e).parentRef;this.field.props.multiple||"inline"===this.field.props.display_as||this.onSave()}"inline"===this.field.props.display_as&&this.saveValue()},validate(e){var t;this.$root.shouldValidate()&&(t=[],e=!(Array.isArray(e)&&1<=e.length),this.$root.shouldValidateRequired()&&this.field.required&&e&&t.push(this.$root.get_error("required")),this.field.validation.errors=t)}},computed:{searchResults(){var t,i;return!!this.search.trim().length&&(t=[],i=e=>{-1!==e.label.toLowerCase().indexOf(this.search.trim().toLowerCase())&&t.push(e),e.children&&e.children.forEach(i)},this.terms.forEach(i),t)}},watch:{"field.value"(){this.validate(this.field.value)}}},e={template:"#product-addon-numeric",props:{product:Object,field:Object,addon:Object},data(){return{value:this.field.value[this.addon.key]}}},t={template:"#product-addon-switcher",props:{product:Object,field:Object,addon:Object},data(){return{value:this.field.value[this.addon.key]}}},i={template:"#product-addon-select",props:{product:Object,field:Object,addon:Object},data(){return{value:this.field.value[this.addon.key],active:null}},methods:{beforeSubmit(){Object.values(this.value.choices).forEach(e=>{"number"==typeof e.price&&0<=e.price?e.enabled=!0:(e.enabled=!1,e.price=null)})}}},s={template:"#product-addon-custom-select",props:{product:Object,field:Object,addon:Object},data(){return{value:this.field.value[this.addon.key],active:null,list:[],addon_id:[this.product.field.key,this.field.field.key,this.addon.key].join(".")}},created(){null===this.value.choices&&(this.value.choices={}),Object.keys(this.value.choices).forEach(e=>{var t=this.value.choices[e];t.value=e,this.list.push(t)})},methods:{insertChoice(){var e=jQuery.extend(!0,{},this.addon.props.choice);this.active=e,this.list.push(e),this.$nextTick(()=>{this.$refs.formGroup.querySelector(".ts-field-repeater:not(.collapsed) .ts-choice-label .ts-filter")?.focus()})},deleteChoice(t){this.list=this.list.filter(e=>e!==t)},beforeSubmit(e,s){let a={};this.list.forEach(e=>{var t,i;"string"==typeof e?.value&&e.value.length&&(t={value:e.value,price:e.price,subheading:e.subheading,image:null},["cards","radio","checkboxes"].includes(this.addon.props.display_mode)&&(t.quantity={enabled:e.quantity.enabled,min:e.quantity.min,max:e.quantity.max}),["cards","images"].includes(this.addon.props.display_mode)&&(i=`files[${this.addon_id+"."+e.value}][]`,Array.isArray(e.image))&&e.image.length&&("new_upload"===(e=e.image[0]).source?(s.append(i,e.item),t.image="uploaded_file"):"existing"===e.source&&(t.image=e.id)),a[t.value]=t)}),this.value.choices=a}}},e={template:"#product-addons",props:{product:Object,field:Object,productType:Object},components:{addonNumeric:e,addonSwitcher:t,addonSelect:i,addonMultiselect:i,addonCustomSelect:s,addonCustomMultiselect:s},data(){return{value:this.productType.value.addons}},methods:{beforeSubmit(t,i){Object.values(this.field.props.addons).forEach(e=>{e=this.$refs["addon:"+e.key]?.[0];"function"==typeof e?.beforeSubmit&&e.beforeSubmit(t,i)})}}},t={template:"#product-base-price",props:{product:Object,productType:Object,field:Object},data(){return{value:this.productType.value.base_price}}},i={template:'<div class="ts-calendar-wrapper ts-availability-calendar"><input type="hidden" ref="input"></div>',props:{booking:Object},data(){return{picker:null,today:new Date,weekdays:["sun","mon","tue","wed","thu","fri","sat"]}},mounted(){this.picker=new Pikaday({field:this.$refs.input,container:this.$el,bound:!1,firstDay:1,keyboardInput:!1,onSelect:e=>{var t=Voxel.helpers.dateFormatYmd(e);this.booking.value.excluded_days.includes(t)?this.booking.value.excluded_days=this.booking.value.excluded_days.filter(e=>e!==t):this.booking.value.excluded_days.push(t)},selectDayFn:e=>this.booking.value.excluded_days.includes(Voxel.helpers.dateFormatYmd(e)),disableDayFn:e=>e<this.today||!("days"!==this.booking.field.props.booking_type||!this.booking.value.excluded_weekdays.includes(this.weekdays[e.getDay()]))||!("timeslots"!==this.booking.field.props.booking_type||!this.booking.$refs.timeslots.unusedDays.includes(this.weekdays[e.getDay()]))||void 0}),"days"===this.booking.field.props.booking_type?this.$watch(()=>this.booking.value.excluded_weekdays,()=>this.refresh(),{deep:!0}):"timeslots"===this.booking.field.props.booking_type&&this.$watch(()=>this.booking.$refs.timeslots.unusedDays,()=>this.refresh())},unmounted(){this.picker.destroy()},methods:{refresh(){this.picker.draw()}}},s={template:"#product-weekday-exclusions",props:{booking:Object},methods:{toggleDay(e){var t=this.booking.value.excluded_weekdays;t.includes(e)?t.splice(t.indexOf(e),1):t.push(e)}},computed:{label(){return Object.keys(this.booking.field.props.weekdays).filter(e=>this.booking.value.excluded_weekdays.includes(e)).map(e=>this.booking.field.props.weekdays[e]).join(", ")}}},p={template:"#product-timeslots",props:{booking:Object},data(){return{active:null,groups:this.booking.value.timeslots.groups,generate:{from:"09:00",to:"17:00",length:30,gap:0},showGenerate:!1}},methods:{isDayUsed(e,t){return-1<t.days.indexOf(e)},isDayAvailable(e,t){return this.isDayUsed(e,t)||-1!==this.unusedDays.indexOf(e)},addGroup(){var e={days:[],slots:[]};this.groups.push(e),this.active=e,this.showGenerate=!1},createSlot(e){e.slots.length<50&&e.slots.push({from:"09:00",to:"09:30"})},removeSlot(t,e){e.slots=e.slots.filter(e=>e!==t)},removeGroup(t){this.groups=this.booking.value.timeslots.groups=this.groups.filter(e=>e!==t)},toggleDay(t,e){this.isDayUsed(t,e)?e.days=e.days.filter(e=>e!==t):e.days.push(t)},groupKey(e,t=""){t=t.length?"."+t:"";return`${this.booking.product.key}.${this.booking.field.key}.slots.`+e+t},groupLabel(t){return Object.keys(this.booking.field.props.weekdays).filter(e=>t.days.includes(e)).map(e=>this.booking.field.props.weekdays[e]).join(", ")},groupLabelShort(t){return Object.keys(this.booking.field.props.weekdays_short).filter(e=>t.days.includes(e)).map(e=>this.booking.field.props.weekdays_short[e]).join(", ")},generateSlots(e){var t=this.generate.from.split(":"),i=this.generate.to.split(":"),s=this.generate.length,a=this.generate.gap,r=parseInt(t[0],10),t=parseInt(t[1],10),l=parseInt(i[0],10),i=parseInt(i[1],10);if(!(isNaN(r)||isNaN(t)||isNaN(l)||isNaN(i)||s<5)){var o=[],d=60*r+t,n=60*l+i;for(n<=d&&(n+=1440);d<n&&!(n<d+s)&&!(50<=o.length);){var h={hour:Math.floor(d/60),minute:d%60},u={hour:Math.floor((d+s)/60),minute:(d+s)%60};24<=h.hour&&(h.hour-=24),24<=u.hour&&(u.hour-=24),o.push({from:[h.hour.toString().padStart(2,"0"),h.minute.toString().padStart(2,"0")].join(":"),to:[u.hour.toString().padStart(2,"0"),u.minute.toString().padStart(2,"0")].join(":")}),d+=s+a}e.slots=o,this.showGenerate=!1}}},computed:{unusedDays(){let t=[];return this.groups.forEach(e=>t=t.concat(e.days)),Object.keys(this.booking.field.props.weekdays).filter(e=>!t.includes(e))}}},i={template:"#product-booking",props:{product:Object,field:Object,productType:Object},components:{bookingCalendar:i,weekdayExclusions:s,timeSlots:p},data(){return{value:this.productType.value.booking}},methods:{toggleWeekdayExclusion(e){var t=this.value.excluded_weekdays;t.includes(e)?t.splice(t.indexOf(e),1):t.push(e)}},computed:{excludedWeekdays(){return Object.keys(this.field.props.weekdays).filter(e=>this.value.excluded_weekdays.includes(e)).map(e=>this.field.props.weekdays[e]).join(", ")}}},s={template:"#product-deliverables",props:{product:Object,field:Object,productType:Object},data(){return{value:this.productType.value.deliverables,files:this.productType.value.deliverables.files}},created(){Array.isArray(this.files)||(this.files=[])},methods:{beforeSubmit(e,t){let i=`files[${this.product.field.key}.deliverables][]`,s=[];Array.isArray(this.files)&&this.files.length&&this.files.forEach(e=>{"new_upload"===e.source?(t.append(i,e.item),s.push("uploaded_file")):"existing"===e.source&&s.push(e.id)}),this.value.files=s}}},p={template:"#product-shipping",props:{product:Object,field:Object,productType:Object},data(){return{value:this.productType.value.shipping}}},_={template:"#product-stock",props:{product:Object,field:Object,productType:Object},data(){return{value:this.productType.value.stock}}},k={template:"#product-subscription-interval",props:{product:Object,field:Object,productType:Object},data(){return{value:this.productType.value.subscription}},computed:{maxFrequency(){var e=this.value.unit;return"day"===e?365:"week"===e?156:"month"===e?36:3}}},x={template:"#product-attribute",props:{product:Object,field:Object,attributes:Object,attribute:Object,productType:Object},data(){return{activeChoice:null}},methods:{createChoice(){var e={id:this.field.randomId(6)};this.activeChoice=e,this.attribute.choices.push(e),this.$nextTick(()=>{this.$refs.formGroup.querySelector(".ts-field-repeater:not(.collapsed)")?.querySelector(".ts-choice-label .ts-filter")?.focus()})},deleteChoice(t){this.attribute.choices=this.attribute.choices.filter(e=>e!==t)},toggleChoice(e){this.attribute.choices[e.value]?delete this.attribute.choices[e.value]:this.attribute.choices[e.value]={enabled:!0}}}},x={template:"#product-attributes",props:{product:Object,field:Object,productType:Object},emits:["change:attributes"],components:{attribute:x},data(){return{value:this.field.value,active:null}},created(){null===this.value.attributes&&(this.value.attributes={}),Object.keys(this.value.attributes).forEach(e=>{let t=this.value.attributes[e];t.key=e,"custom"===t.type&&Object.keys(t.choices).forEach(e=>{t.choices[e].id=e})}),this.field.attributeList=Object.values(this.value.attributes),this.field.attributeList.forEach(e=>{"custom"===e.type&&(e.choices=Object.values(e.choices))}),this.$watch(()=>this.field.attributeList,()=>this.$emit("change:attributes",this.field.attributeList,this),{deep:!0})},methods:{createAttribute(){this.field.attributeList.push({type:"custom",key:this.field.randomId(6),label:this.field.field.props.l10n.new_attribute_label,display_mode:"dropdown",choices:[]}),this.active=this.field.attributeList.at(-1),this.$nextTick(()=>{this.$refs.attribute.$refs.formGroup.querySelector(".variation-box .ts-attribute-label .ts-filter")?.focus()})},useAttribute(e){this.field.attributeList.push({type:"existing",key:e.key,choices:{}}),this.active=this.field.attributeList.at(-1)},isUsed(t){return this.field.attributeList.find(e=>"existing"===e.type&&e.key===t.key)},getPreset(e){return this.field.getAttributePreset(e)},getLabel(e){return this.field.getAttributeLabel(e)},getChoiceCount(e){if("existing"!==e.type)return e.choices.length;{let t=0;return Object.values(e.choices).forEach(e=>e.enabled&&t++),t}},deleteAttribute(t){this.field.attributeList=this.field.attributeList.filter(e=>e!==t)},beforeSubmit(e,r){let i={};this.field.attributeList.forEach(a=>{if("existing"===a.type){let t={};Object.keys(a.choices).forEach(e=>{a.choices[e].enabled&&(t[e]={enabled:!0})}),i[a.key]={type:"existing",choices:t}}else if("custom"===a.type){let s={};a.choices.forEach(e=>{var t,i;s[e.id]={label:e.label,color:e.color,subheading:e.subheading,image:null},["cards","images"].includes(a.display_mode)&&(t=`files[${this.product.field.key+".custom-attributes."+e.id}][]`,Array.isArray(e.image))&&e.image.length&&("new_upload"===(i=e.image[0]).source?(r.append(t,i.item),s[e.id].image="uploaded_file"):"existing"===i.source&&(s[e.id].image=i.id))}),i[a.key]={type:"custom",label:a.label,display_mode:a.display_mode,choices:s}}}),this.value.attributes=i}}},w={template:"#product-variation-base-price",props:{product:Object,variations:Object,variation:Object,field:Object,productType:Object},data(){return{value:this.variation.config.base_price}}},$={template:"#product-variation-stock",props:{product:Object,variations:Object,variation:Object,field:Object,productType:Object},data(){return{value:this.variation.config.stock}}},j={template:"#product-variation-bulk-settings",props:{product:Object,variations:Object,variation:Object,productType:Object},data(){return{open:!1,copy:{what:"price",where:"all"}}},methods:{getWhereChoices(){let s=[];return this.variations.attributeList?.forEach(t=>{var e,i;"custom"===t.type?(e=t.choices.find(e=>e.id===this.variation.attributes[t.key])?.label,s.push({key:t.key,label:t.label+": "+e})):(i=(e=this.variations.getAttributePreset(t)).choices.find(e=>e.value===this.variation.attributes[t.key])?.label,s.push({key:t.key,label:e.label+": "+i}))}),s},apply(){var e,t=this.copy.what,i=this.copy.where,s={};"all"!==t&&"price"!==t||(s.price=this.variation.config.base_price,s.enabled=this.variation.enabled),"all"!==t&&"image"!==t||(s.image=this.variation.image),!this.variations.field.props.stock.enabled||"all"!==t&&"stock"!==t||(s.stock=this.variation.config.stock);let a=0;for(e of this.variations.variationList)e.id===this.variation.id||"all"!==i&&e.attributes[i]!==this.variation.attributes[i]||(a++,s.price&&(e.enabled=s.enabled,e.config.base_price.amount=s.price.amount,this.variations.field.props.fields["base-price"].props.discount_price.enabled)&&(e.config.base_price.discount_amount=s.price.discount_amount),s.image&&(e.image||(e.image=[]),e.image.length=0,s.image.length)&&e.image.push(s.image[0]),s.stock&&(e.config.stock.enabled=s.stock.enabled,e.config.stock.quantity=s.stock.quantity,e.config.stock.sold_individually=s.stock.sold_individually));1<a&&(t=1===a?this.variations.field.props.l10n.one_variation_updated:this.variations.field.props.l10n.multiple_variations_updated.replace("@count",a),Voxel.alert(t,"success",3e3),this.open=!1)}}},x={template:"#product-variations",props:{product:Object,field:Object,productType:Object},components:{attributes:x,variationBasePrice:w,variationStock:$,variationBulkSettings:j},data(){return{value:this.productType.value.variations,attributeList:null,activeVariation:null,variationList:null,keyMapCache:{}}},created(){null===this.value.variations&&(this.value.variations={}),Object.keys(this.value.variations).forEach(e=>{var t=this.value.variations[e];t.id=e,t._key=JSON.stringify(this.sortObject(t.attributes))}),this.variationList=Object.values(this.value.variations)},methods:{sortObject(e){return Object.fromEntries(Object.entries(e).sort())},getAttributePreset(t){return this.field.props.attributes.find(e=>e.key===t.key)},getAttributeLabel(e){return"existing"===e.type?this.getAttributePreset(e)?.label:e.label},getVariationLabel(i){let s=[];return this.attributeList?.forEach(t=>{var e;"custom"===t.type?s.push(t.choices.find(e=>e.id===i.attributes[t.key])?.label):(e=this.getAttributePreset(t),s.push(e.choices.find(e=>e.value===i.attributes[t.key])?.label))}),s.filter(Boolean).join(" / ")},onAttributesUpdate(e){e=(e=e.filter(e=>Object.values(e.choices).length)).length?this._generateCombinations(e):[];let i=[];this.variationList.forEach(e=>this.keyMapCache[e._key]=e),e.forEach(e=>{var t=JSON.stringify(this.sortObject(e));this.keyMapCache[t]?i.push(this.keyMapCache[t]):((t=jQuery.extend(!0,{},this.field.props.variation_props)).id=this.randomId(8),t.attributes=this.sortObject(e),t.image=[],t._key=JSON.stringify(this.sortObject(t.attributes)),i.push(t))}),this.variationList=i},_generateCombinations(i,s=0,a={},r=[]){if(!(r.length>=this.field.props.max_variations))if(s===i.length)r.push({...a});else{let t=i[s];t.id;var l,o=t.key;"custom"===t.type?l=t.choices:(l=[],this.field.props.attributes.find(e=>e.key===t.key).choices.forEach(e=>{t.choices[e.value]?.enabled&&l.push(e.value)}));for(let e=0;e<l.length;e++)a[o]="custom"===t.type?l[e].id:l[e],this._generateCombinations(i,s+1,a,r)}return r},randomId(t=8){var i="0123456789abcdefghijklmnopqrstuvwxyz",s=i.length-1;let a="";var r;for(let e=0;e<t;e++){r=0,l=s;var l=Math.floor(r+Math.random()*(l-r+1));a+=i[l]}return a},beforeSubmit(e,s){this.$refs.attributes.beforeSubmit(e,s);let a={};this.variationList.forEach(e=>{a[e.id]={attributes:e.attributes,config:e.config,image:null,enabled:e.enabled};var t,i=`files[${this.product.field.key+".variations."+e.id}][]`;Array.isArray(e.image)&&e.image.length&&("new_upload"===(t=e.image[0]).source?(s.append(i,t.item),a[e.id].image="uploaded_file"):"existing"===t.source&&(a[e.id].image=t.id)),e.enabled&&!this.hasValidPrice(e)&&(a[e.id].enabled=!1)}),this.value.variations=a},hasValidPrice(e){return"number"==typeof e.config.base_price.amount},hasValidStock(e){return!this.field.props.stock.enabled||!e.config.stock.enabled||1<=e.config.stock.quantity}}},w={template:"#product-custom-prices-single",props:{product:Object,customPrices:Object,pricing:Object,productType:Object},data(){return{}},created(){this.customPrices.field.props.addons.enabled&&this.handleCustomChoices()},methods:{createCondition(){this.pricing.conditions.push({type:"day_of_week",days:[],date:null,range:{from:null,to:null}})},deleteCondition(e){this.pricing.conditions.splice(this.pricing.conditions.indexOf(e),1)},conditionKey(e,t=""){t=t.length?"."+t:"";return`${this.product.field.key}.${this.customPrices.field.key}.conditions.`+e+t},conditionLabel(t){if("day_of_week"===t.type)return Object.keys(this.customPrices.field.props.weekdays).filter(e=>t.days.includes(e)).map(e=>this.customPrices.field.props.weekdays[e]).join(", ");if("date"===t.type){var e=new Date(t.date+"T00:00:00");if(e&&isFinite(e))return Voxel.helpers.dateFormat(e)}else if("date_range"===t.type){var e=new Date(t.range.from+"T00:00:00"),i=new Date(t.range.to+"T00:00:00");if(e&&i&&isFinite(e)&&isFinite(i))return Voxel.helpers.dateFormat(e)+" - "+Voxel.helpers.dateFormat(i)}},toggleDay(e,t){var i=t.days.indexOf(e);-1!==i?t.days.splice(i,1):t.days.push(e)},isAddonActive(t){var e=this.productType.fields.addons.props.addons[t],t=this.productType.value.addons[t];let i=e.required||t.enabled;if(["select","multiselect","custom-select","custom-multiselect"].includes(e.type)){let e=!1;for(var s of Object.values(t.choices))if(null!==s.price&&""!==s.price){e=!0;break}i=i&&e}return i},isChoiceActive(e,t){var i=this.productType.fields.addons.props.addons[t],t=this.productType.value.addons[t];return"select"===i.type||"multiselect"===i.type?null!==t.choices[e.value].price&&""!==t.choices[e.value].price:null!==e.price&&""!==e.price},handleCustomChoices(){Object.keys(this.pricing.prices.addons).forEach(i=>{var e=this.productType.fields.addons.props.addons[i];if("custom-select"===e.type||"custom-multiselect"===e.type){let e=this.getAddonRef(i),t=(this.pricing.prices.addons[i]||(this.pricing.prices.addons[i]={}),e=>{let t=this.pricing.prices.addons[i];this.pricing.prices.addons[i]={},e.forEach(e=>{this.pricing.prices.addons[i][e.value]||(this.pricing.prices.addons[i][e.value]={price:t[e.value]?.price})})});t(e.list),this.$watch(()=>e.list,e=>{t(e)},{deep:!0})}})},getAddonRef(e){return this.product.$refs[`type:${this.productType.key}-field:addons`][0].$refs["addon:"+e][0]}}},$={template:"#product-custom-prices",props:{product:Object,field:Object,productType:Object},components:{singlePrice:w},data(){return{value:this.productType.value.custom_prices,active:null}},methods:{createPrice(){this.value.list.push({enabled:!0,label:"",conditions:[],prices:this.field.props.prices_schema}),this.active=this.value.list.at(-1),this.$nextTick(()=>{this.$refs.prices.$el.querySelector(".ts-field-repeater:not(.collapsed) .ts-pricing-label .ts-filter")?.focus()})},deletePrice(e){this.value.list.splice(this.value.list.indexOf(e),1)}}},O={template:"#create-post-product-field",props:{field:Object},components:{"field-addons":e,"field-base-price":t,"field-booking":i,"field-deliverables":s,"field-shipping":p,"field-stock":_,"field-subscription-interval":k,"field-variations":x,"field-custom-prices":$},data(){return{product_type:null}},created(){this.set_initial_product_type()},methods:{set_initial_product_type(){var e=this.field.props.product_types[this.field.value.product_type];(this.product_type=e).value=this.field.value},set_product_type(e){e=this.field.props.product_types[e];e.value.enabled=!0,this.field.value=e.value,this.product_type=e},onSubmit(t,i){Object.values(this.product_type.fields).forEach(e=>{e=this.$refs[`type:${this.product_type.key}-field:`+e.key]?.[0];"function"==typeof e?.beforeSubmit&&e.beforeSubmit(t,i)}),t[this.field.key]=this.field.value,this.$refs.deliverables?.onSubmit(t[this.field.key],i)},validate(t){if(this.$root.shouldValidate()){var i=[];let e=!0;(this.field.required||t.enabled)&&(e=!1),this.$root.shouldValidateRequired()&&this.field.required&&e&&i.push(this.$root.get_error("required")),this.field.validation.errors=i}}}},V={template:"#create-post-ui-image-field",props:{field:Object}},D={template:"#create-post-ui-heading-field",props:{field:Object}},S={template:"#create-post-ui-html-field",props:{field:Object},mounted(){let e=jQuery.parseHTML(this.field.props.content,document,!0);this.$nextTick(()=>{jQuery(this.$refs.composer).append(e)})}},F={template:"#create-post-repeater-field",props:{field:Object},data(){return{rows:this.field.props.rows,active:null}},created(){this.rows.forEach(e=>{this.$root.setupConditions(e),e["meta:state"].id=Voxel.helpers.sequentialId()})},mounted(){this.$nextTick(()=>this.rows.forEach(e=>this.getRowLabel(e)))},methods:{addRow(){let e=Vue.reactive(jQuery.extend(!0,{},this.field.props.fields));e["meta:state"].id=Voxel.helpers.sequentialId(),this.rows.push(e),this.active=e,this.$root.setupConditions(e),this.$nextTick(()=>this.getRowLabel(e))},onSubmit(e,r){e[this.field.key]=[],this.rows.forEach((i,s)=>{var a={};Object.values(i).forEach(e=>{var t=this.$refs[`row#${i["meta:state"].id}:`+e.key]?.[0];"meta:state"!==e.key&&!e.is_ui&&this.$root.conditionsPass(e)&&("function"==typeof t?.onSubmit?t.onSubmit(a,r,s):null!==e.value&&(a[e.key]=e.value))}),e[this.field.key].push(a)})},getRowLabel(e){let t=e["meta:state"],i=e=>t.label=e,s=(this.field.props.row_label,this.field.props.l10n.item),a=e[this.field.props.row_label],r=this.$refs[`row#${t.id}:`+a?.key]?.[0];a&&r?"taxonomy"===a.type||"post-relation"===a.type?(r.$watch("displayValue",()=>i(r.displayValue||s)),i(r.displayValue||s)):"select"===a.type?(this.$watch(()=>a.value,()=>i(a.props.choices[a.value]?.label||s)),i(a.props.choices[a.value]?.label||s)):"date"===a.type?(r.$watch("displayValue",()=>i(r.displayValue||s)),i(r.displayValue||s)):(this.$watch(()=>a.value,()=>i(a.value?.toString()||s)),i(a.value?.toString()||s)):i(s)},validate(e){if(this.$root.shouldValidate()){var t=[],i=(e=this.rows,!(Array.isArray(e)&&1<=e.length)),s=this.field.props.min_rows,a=this.field.props.max_rows;if(this.$root.shouldValidateRequired()&&this.field.required&&i&&t.push(this.$root.get_error("required")),!i){s&&e.length<s&&t.push(this.$root.replace_vars(this.$root.get_error("repeater:min"),{"@min":s})),a&&e.length>a&&t.push(this.$root.replace_vars(this.$root.get_error("repeater:max"),{"@max":a}));for(let i of e)Object.values(i).forEach(e=>{var t=i["meta:state"].id;"meta:state"!==e.key&&"function"==typeof(t=this.$refs[`row#${t}:`+e.key]?.[0])?.validate&&t.validate(t.field.value)});this.hasInvalidRows()&&t.push(this.$root.get_error("repeater:row-error"))}this.field.validation.errors=t}},validate_subfield(e,t){t=this.$refs["row#"+t+":"+e]?.[0];"function"==typeof t?.validate&&t.validate(t.field.value)},hasInvalidRows(){for(var e of this.rows)for(var t of Object.values(e))if("meta:state"!==t.key){var i=this.$refs[`row#${e["meta:state"].id}:`+t.key]?.[0];if(t.validation.errors.length||"repeater"===t.type&&i?.hasInvalidRows?.())return!0}return!1}},watch:{"rows.length"(){this.validate(this.rows)}}},T={template:"#create-post-timezone-field",props:{field:Object},data(){return{search:""}},methods:{onSave(){this.$refs.formGroup.blur()},onClear(){this.field.value=null,this.search=""},validate(e){var t;this.$root.shouldValidate()&&(t=[],e=!("string"==typeof e&&1<=e.trim().length),this.$root.shouldValidateRequired()&&this.field.required&&e&&t.push(this.$root.get_error("required")),this.field.validation.errors=t)}},computed:{choices(){return this.search.trim().length?this.field.props.list.filter(e=>-1!==e.toLowerCase().indexOf(this.search.trim().toLowerCase())):this.field.props.list}},watch:{"field.value"(){this.validate(this.field.value)}}},j={template:"#recurring-date-range-picker",props:{date:Object},emits:["save"],data(){return{picker:null,activePicker:"start",value:{start:this.date.startDate?new Date(this.date.startDate+"T00:00:00"):null,end:this.date.endDate?new Date(this.date.endDate+"T00:00:00"):null}}},mounted(){this.picker=new Pikaday({field:this.$refs.input,container:this.$refs.calendar,bound:!1,firstDay:1,keyboardInput:!1,numberOfMonths:2,defaultDate:this.value.start,startRange:this.value.start,endRange:this.value.end,theme:"pika-range",onSelect:e=>{"start"===this.activePicker?(this.setStartDate(e),this.setEndDate(null),this.activePicker="end"):(this.setEndDate(e),this.activePicker="start",this.date.startDate=Voxel.helpers.dateFormatYmd(this.value.start),this.date.endDate=Voxel.helpers.dateFormatYmd(this.value.end),this.$emit("save")),this.refresh()},selectDayFn:e=>!(!this.value.start||e.toDateString()!==this.value.start.toDateString())||!(!this.value.end||e.toDateString()!==this.value.end.toDateString())||void 0,disableDayFn:e=>{if("end"===this.activePicker&&this.value.start&&e<=this.value.start)return!0}}),this.setStartDate(this.value.start),this.setEndDate(this.value.end),this.refresh()},unmounted(){setTimeout(()=>this.picker.destroy(),200)},methods:{setStartDate(e){this.value.start=e,this.picker.setStartRange(e),this.value.end&&this.value.start>this.value.end&&this.setEndDate(null)},setEndDate(e){this.value.end=e,this.picker.setEndRange(e)},refresh(){this.picker.draw()},reset(){this.setStartDate(null),this.setEndDate(null),this.refresh(),this.activePicker="start"}},computed:{startLabel(){return this.value.start?Voxel.helpers.dateFormat(this.value.start):"From"},endLabel(){return this.value.end?Voxel.helpers.dateFormat(this.value.end):"To"}},watch:{activePicker(){this.refresh()}}},E={template:"#create-post-recurring-date-field",props:{field:Object,index:{type:Number,default:0}},components:{datePicker:{template:"#recurring-date-picker",props:["modelValue","minDate"],emits:["update:modelValue"],data(){return{picker:null}},mounted(){this.picker=new Pikaday({field:this.$refs.input,container:this.$refs.calendar,bound:!1,firstDay:1,keyboardInput:!1,defaultDate:this.modelValue?new Date(this.modelValue):null,onSelect:e=>{this.$emit("update:modelValue",Voxel.helpers.dateFormatYmd(e))},selectDayFn:e=>this.modelValue&&this.modelValue===Voxel.helpers.dateFormatYmd(e)})},unmounted(){setTimeout(()=>this.picker.destroy(),200)},watch:{modelValue(){this.picker.draw()}}},dateRangePicker:j},methods:{add(){this.field.value.push({multiday:!1,startDate:null,startTime:"09:00",endDate:null,endTime:"10:00",allday:!1,repeat:!1,frequency:1,unit:"week",until:null})},remove(e){this.field.value.splice(this.field.value.indexOf(e),1)},id(){return this.field.id+":"+this.index+"."+Object.values(arguments).join(".")},clearDate(e){e.startDate=null,e.startTime=null,e.endDate=null,e.endTime=null,this.$refs.rangePicker?.[0]?.reset()},singleDatePicked(e){var t=new Date(e.startDate+"T00:00:00Z"),t=new Date(t);t.setDate(t.getDate()+1),e.endDate=Voxel.helpers.dateFormatYmd(t)},getStartDate(e){var t=e.startTime||"00:00:00",t=new Date(e.startDate+" "+t);return e.startDate&&isFinite(t)?t:null},getEndDate(e){var t=e.endTime||"00:00:00",t=new Date(e.endDate+" "+t);return e.endDate&&isFinite(t)?t:null},getUntilDate(e){var t=new Date(e.until);return e.until&&isFinite(t)?t:null},format(e){return Voxel.helpers.dateTimeFormat(e)},formatDate(e){return Voxel.helpers.dateFormat(e)},validate(e){if(this.$root.shouldValidate()){let t=[];var i=!(Array.isArray(e)&&1<=e.length),s=this.field.props.max_date_count;this.$root.shouldValidateRequired()&&this.field.required&&i&&t.push(this.$root.get_error("required")),i||(s&&e.length>s&&t.push(this.$root.replace_vars(this.$root.get_error("recurring-date:max"),{"@max":s})),e.forEach(e=>{e.startDate&&(!e.multiday||e.endDate)||t.push(this.$root.get_error("recurring-date:empty")),e.repeat&&!e.until&&t.push(this.$root.get_error("recurring-date:missing-until"))})),this.field.validation.errors=t}}}},q={template:"#create-post-date-field",components:{datePicker:{template:'<div class="ts-form-group" ref="calendar"><input type="hidden" ref="input"></div>',props:{field:Object,parent:Object},data(){return{picker:null}},mounted(){this.picker=new Pikaday({field:this.$refs.input,container:this.$refs.calendar,bound:!1,firstDay:1,keyboardInput:!1,defaultDate:this.parent.date,onSelect:e=>{this.parent.date=e,this.parent.onSave()},selectDayFn:e=>this.parent.date&&this.parent.date.toDateString()===e.toDateString()})},unmounted(){setTimeout(()=>this.picker.destroy(),200)},methods:{reset(){this.parent.date=null,this.picker.draw()}}}},props:{field:Object,index:{type:Number,default:0}},data(){return{date:this.field.value.date,time:this.field.value.time,displayValue:""}},created(){"string"==typeof this.date&&(this.date=new Date(this.date+"T00:00:00"),this.displayValue=this.getDisplayValue())},methods:{saveValue(){this.field.value.date=this.isFilled()?Voxel.helpers.dateFormatYmd(this.date):null,this.displayValue=this.getDisplayValue()},onSave(){this.saveValue(),this.$refs.formGroup.blur()},onClear(){this.$refs.picker.reset()},isFilled(){return this.date&&isFinite(this.date)},getDisplayValue(){return this.date?Voxel.helpers.dateFormat(this.date):""},validate(e){var t,i;this.$root.shouldValidate()&&(t=[],i=!!this.field.props.enable_timepicker,i=!("object"==typeof e&&e.date&&(!i||e.time)),this.$root.shouldValidateRequired()&&this.field.required&&i&&t.push(this.$root.get_error("required")),this.field.validation.errors=t)}},watch:{"field.value.date"(){this.validate(this.field.value)},"field.value.time"(){this.validate(this.field.value)}}},C={template:"#create-post-select-field",props:{field:Object,index:{type:Number,default:0}},data(){return{value:this.field.value}},created(){null===this.field.value||this.field.props.choices[this.field.value]||(this.field.value=null,this.value=null),null===this.value&&this.field.required&&(this.value=Object.values(this.field.props.choices)[0]?.value,this.saveValue()),this.$watch(()=>this.field.value,()=>this.validate(this.field.value))},methods:{saveValue(){this.field.value=this.isFilled()?this.value:null},isFilled(){return null!==this.value&&this.field.props.choices[this.value]},validate(e){var t;this.$root.shouldValidate()&&(t=[],e=!("string"==typeof e&&1<=e.trim().length),this.$root.shouldValidateRequired()&&this.field.required&&e&&t.push(this.$root.get_error("required")),this.field.validation.errors=t)}}},L={template:"#create-post-color-field",props:{field:Object},methods:{validate(e){var t,i;this.$root.shouldValidate()&&(t=[],i=!("string"==typeof e&&1<=e.trim().length),this.$root.shouldValidateRequired()&&this.field.required&&i&&t.push(this.$root.get_error("required")),i||/^#([A-Fa-f0-9]{3}){1,2}$/.test(e)||t.push(this.$root.get_error("color:invalid")),this.field.validation.errors=t)}},watch:{"field.value"(){this.validate(this.field.value)}}},P={template:"#create-post-post-relation-field",props:{field:Object,index:{type:Number,default:0}},data(){return{posts:{loading:!1,has_more:!1,list:null},value:this.field.props.selected,displayValue:"",search:{term:"",offset:0,loading:!1,loading_more:!1,has_more:!1,list:null}}},created(){this.displayValue=this._getDisplayValue()},methods:{onOpen(){null===this.posts.list&&(this.posts.list=[],this.loadPosts())},loadPosts(){this.posts.loading=!0,jQuery.get(Voxel_Config.ajax_url+"&action=create_post.relations.get_posts",{offset:this.posts.list.length,post_id:this.$root.post?.id,exclude:this.$root.post?.id,post_type:this.$root.config.post_type.key,field_key:this.field.key,field_path:this.field.path}).always(e=>{this.posts.loading=!1,e.success?(this.posts.list.push(...e.data),this.posts.has_more=e.has_more):Voxel.alert(e.message||Voxel_Config.l10n.ajaxError,"error")})},saveValue(){this.field.value=this.isFilled()?Object.keys(this.value):null,this.displayValue=this._getDisplayValue()},onSave(){this.saveValue(),this.$refs.formGroup.blur()},onClear(){Object.keys(this.value).forEach(e=>delete this.value[e])},isFilled(){return Object.keys(this.value).length},_getDisplayValue(){var e=Object.values(this.value);let t="";return e[0]&&(t+=e[0].title),1<e.length&&(t+=" +"+(e.length-1)),t},selectPost(e){this.value[e.id]?delete this.value[e.id]:(this.field.props.multiple||Object.keys(this.value).forEach(e=>delete this.value[e]),this.value[e.id]=e,this.field.props.multiple||this.onSave())},clientSearchPosts(){let t=this.search.term.trim().toLowerCase(),i=[],s=!1;this.posts.list.forEach(e=>{s||-1!==e.title.toLowerCase().indexOf(t)&&(i.push(e),s=10<=i.length)}),this.search.list=i,this.search.loading=!1,this.search.has_more=!1,this.search.loading_more=!1},serverSearchPosts:Voxel.helpers.debounce((t,i=!1)=>{jQuery.get(Voxel_Config.ajax_url+"&action=create_post.relations.get_posts",{offset:i?t.search.list.length:0,post_id:t.$root.post?.id,exclude:t.$root.post?.id,search:t.search.term.trim(),post_type:t.$root.config.post_type.key,field_key:t.field.key,field_path:t.field.path}).always(e=>{t.search.loading=!1,t.search.loading_more=!1,e.success?(i?t.search.list.push(...e.data):t.search.list=e.data,t.search.has_more=e.has_more):Voxel.alert(e.message||Voxel_Config.l10n.ajaxError,"error")})}),validate(e){var t,i,s;this.$root.shouldValidate()&&(t=[],i=!(Array.isArray(e)&&1<=e.length),s=this.field.props.multiple?this.field.props.max_count:1,this.$root.shouldValidateRequired()&&this.field.required&&i&&t.push(this.$root.get_error("required")),i||s&&e.length>s&&t.push(this.$root.replace_vars(this.$root.get_error("relation:max"),{"@max":s})),this.field.validation.errors=t)}},watch:{"search.term"(){this.search.term.trim()&&this.posts.list&&(this.search.loading=!0,!this.posts.has_more||this.search.term.trim().length<=2?this.clientSearchPosts():this.serverSearchPosts(this))},"field.value"(){this.validate(this.field.value)}}},A={methods:{setupConditions(i){Object.values(i).forEach(l=>{l.conditions&&l.conditions.forEach(e=>{e.forEach(s=>{var e=s.source.split("."),t=e[0];let a=e[1]||null,r=i[t];if(r){let e=r.value;null!==a&&(e=e?e[a]:null),this.evaluateCondition(s,e,l,r),this.$watch(()=>null!==a?r.value?r.value[a]:null:r.value,(e,t)=>{let i=r.value;null!==a&&(i=i?i[a]:null),this.evaluateCondition(s,i,l,r)},{deep:!0})}})})})},evaluateCondition(e,t,i,s){var a=Voxel.conditionHandlers[e.type];a&&(e._passes=this.conditionsPass(s)&&a(e,t,i,s))},conditionsPass(e){if("create-post"===this.$root.widget&&"ui-step"!==e.type){var t=this.$root.fields[e.step];if(t&&!this.conditionsPass(t))return!1}var i;return!e.conditions||(i=!1,e.conditions.forEach(e=>{var t;e.length&&(t=!0,e.forEach(e=>{e._passes||(t=!1)}),t)&&(i=!0)}),i)}}},R=(window.Voxel.conditionHandlers={"text:equals":(e,t)=>t===e.value,"text:not_equals":(e,t)=>t!==e.value,"text:empty":(e,t)=>!t?.trim()?.length,"text:not_empty":(e,t)=>!!t?.trim()?.length,"text:contains":(e,t)=>t?.match(new RegExp(e.value,"i")),"taxonomy:contains":(e,t)=>Array.isArray(t)&&t.includes(e.value),"taxonomy:not_contains":(e,t)=>!(Array.isArray(t)&&t.includes(e.value)),"taxonomy:empty":(e,t)=>!Array.isArray(t)||!t.length,"taxonomy:not_empty":(e,t)=>Array.isArray(t)&&t.length,"switcher:checked":(e,t)=>!!t,"switcher:unchecked":(e,t)=>!t,"number:empty":(e,t)=>isNaN(parseFloat(t)),"number:equals":(e,t)=>parseFloat(t)===parseFloat(e.value),"number:gt":(e,t)=>parseFloat(t)>parseFloat(e.value),"number:gte":(e,t)=>parseFloat(t)>=parseFloat(e.value),"number:lt":(e,t)=>parseFloat(t)<parseFloat(e.value),"number:lte":(e,t)=>parseFloat(t)<=parseFloat(e.value),"number:not_empty":(e,t)=>!isNaN(parseFloat(t)),"number:not_equals":(e,t)=>parseFloat(t)!==parseFloat(e.value),"file:empty":(e,t)=>!Array.isArray(t)||!t.length,"file:not_empty":(e,t)=>Array.isArray(t)&&t.length,"date:empty":(e,t)=>!isFinite(new Date(t.date+" "+(t.time||"00:00:00"))),"date:gt":(e,t)=>{t=new Date(t.date+" "+(t.time||"00:00:00")),e=new Date(e.value);return!(!isFinite(t)||!isFinite(e))&&e<t},"date:lt":(e,t)=>{t=new Date(t.date+" "+(t.time||"00:00:00")),e=new Date(e.value);return!(!isFinite(t)||!isFinite(e))&&t<e},"date:not_empty":(e,t)=>isFinite(new Date(t.date+" "+(t.time||"00:00:00")))},{template:"#vx-file-upload",props:{field:Object,sortable:{type:Boolean,default:!0},allowedFileTypes:String,maxFileCount:{type:Number,default:1},modelValue:Array,context:Object},emits:["update:modelValue"],data(){return{dragActive:!1,reordering:!1,value:this.modelValue,id:"file-upload-"+Voxel.helpers.sequentialId()}},mounted(){jQuery(this.$refs.input).on("change",e=>{for(var t=0;t<e.target.files.length;t++){var i=e.target.files[t];this.pushFile(i)}this.$refs.input.value="",this.update()})},unmounted(){setTimeout(()=>{Array.isArray(this.value)&&this.value.forEach(e=>{"new_upload"===e.source&&URL.revokeObjectURL(e.preview)})},10)},methods:{getStyle(e){return e.type.startsWith("image/")?`background-image: url('${e.preview}');`:""},pushFile(t){1===this.maxFileCount&&(this.value=[]);var e={source:"new_upload",name:t.name,type:t.type,size:t.size,preview:URL.createObjectURL(t),item:t,_id:Voxel.helpers.randomId(8)},i=(void 0===window._vx_file_upload_cache&&(window._vx_file_upload_cache=[]),window._vx_file_upload_cache.find(e=>e.item.name===t.name&&e.item.type===t.type&&e.item.size===t.size&&e.item.lastModified===t.lastModified));i?this.value.push(i):(this.value.push(e),window._vx_file_upload_cache.unshift(e))},onDrop(e){this.dragActive=!1,e.dataTransfer.items?[...e.dataTransfer.items].forEach(e=>{"file"===e.kind&&this.pushFile(e.getAsFile())}):[...e.dataTransfer.files].forEach(e=>{this.pushFile(e)}),this.update()},onMediaPopupSave(e){1===this.maxFileCount&&(this.value=[]);var t={};this.value.forEach(e=>{"existing"===e.source&&(t[e.id]=!0),"new_upload"===e.source&&(t[e._id]=!0)}),Object.values(e).forEach(e=>{"existing"!==e.source||t[e.id]||this.value.push(e),"new_upload"!==e.source||t[e._id]||this.value.push(e)}),this.update()},update(){this.$emit("update:modelValue",this.value)}},watch:{modelValue(e){this.value=e}}});window.render_create_post=()=>{Array.from(document.querySelectorAll(".ts-create-post")).forEach(e=>{var t,i,s,p;e.__vue_app__||e.classList.contains("no-vue")||(t=JSON.parse(e.closest(".elementor-element").querySelector(".vxconfig").innerHTML),s=e,p=t,(i=Vue.createApp({el:s,mixins:[Voxel.mixins.base],data(){return{widget:"create-post",config:p,activePopup:null,fields:{},steps:[],post_type:{},post:null,step_index:null,submission:{status:null,processing:!1,done:!1,viewLink:null,editLink:null,message:null},validateRequired:!0}},created(){(window.CP=this).fields=p.fields,this.steps=p.steps,this.post_type=p.post_type,this.post=p.post||null,this.setupConditions(this.fields);let t=Voxel.getSearchParam("step");var e=this.activeSteps.findIndex(e=>e===t);t&&0<e?this.setStep(e):this.setStep(0),p.errors.forEach(e=>console.log(e))},mounted(){s.classList.toggle("ts-ready"),p.is_admin_mode&&window.parent.postMessage("create-post:mounted","*")},methods:{prevStep(e=0){0<this.step_index&&this.setStep(this.step_index-1),this.scrollIntoView()},nextStep(e=!1){let t=e?this.validateCurrentStep():null;null!==t?this.$nextTick(()=>{window.scrollTo({top:t.ref.$el?.getBoundingClientRect().top+window.scrollY-100,behavior:"smooth"})}):(this.step_index<this.steps.length-1&&this.setStep(this.step_index+1),this.scrollIntoView())},scrollIntoView(){s.closest(".elementor-element").getBoundingClientRect().top<0&&window.scrollTo({top:0,left:0})},setStep(e){this.step_index=e,0<this.step_index&&this.currentStep?Voxel.setSearchParam("step",this.currentStep.key):Voxel.deleteSearchParam("step")},validateCurrentStep(){this.validateRequired=!0;let i=null;return Object.values(this.fields).forEach(e=>{var t=this.$refs["field:"+e.key];e.step===this.currentStep.key&&!e.is_ui&&this.conditionsPass(e)&&t&&(t.validate(e.value),null===i)&&(e.validation.errors.length||"repeater"===e.type&&t.hasInvalidRows())&&(i={field:e,ref:t})}),i},validateAllFields(){let i=null;return Object.values(this.fields).forEach(e=>{var t=this.$refs["field:"+e.key];!e.is_ui&&this.conditionsPass(e)&&t&&(t.validate(e.value),null===i)&&(e.validation.errors.length||"repeater"===e.type&&t.hasInvalidRows())&&(i={field:e,ref:t})}),i},submit(e={}){this.submission.processing=!0,e.save_as_draft?this.validateRequired=!1:this.validateRequired=!0;let t=this.validateAllFields();if(null!==t)this.setStep(this.activeSteps.findIndex(e=>e===t.field.step)),this.$nextTick(()=>{window.scrollTo({top:t.ref.$el?.getBoundingClientRect().top+window.scrollY-100,behavior:"smooth"})}),this.submission.processing=!1;else{var i,s=new FormData,a={},r=(Object.values(this.fields).forEach(e=>{var t=this.$refs["field:"+e.key];!e.is_ui&&this.conditionsPass(e)&&(t&&"function"==typeof t.onSubmit?t.onSubmit(a,s):null!==e.value&&(a[e.key]=e.value))}),s.append("postdata",JSON.stringify(a)),{});for(i in Object.fromEntries(s))if(i.startsWith("files[")){var l,o,d=s.getAll(i),n=[];for(l in d){var h,u=d[l];u instanceof File&&(void 0!==r[h=JSON.stringify({name:u.name,type:u.type,size:u.size,lastModified:u.lastModified})]?(s.append(`_vx_file_aliases[${i.slice(6,-3)}][${l}][path]`,r[h].path),s.append(`_vx_file_aliases[${i.slice(6,-3)}][${l}][index]`,r[h].index)):(n.push(u),r[h]={path:i.slice(6,-3),index:n.indexOf(u)}))}s.delete(i);for(o of n)s.append(i,o)}e.save_as_draft&&s.append("save_as_draft","yes");e=jQuery.param({action:p.is_admin_mode?"create_post__admin":"create_post",post_type:this.post_type.key,post_id:this.post?.id,admin_mode:p.is_admin_mode?p.admin_mode_nonce:null});jQuery.post({url:Voxel_Config.ajax_url+"&"+e,data:s,contentType:!1,processData:!1}).always(e=>{this.submission.processing=!1,p.is_admin_mode?window.parent.postMessage("create-post:submitted","*"):e.success?(this.submission.done=!0,this.submission.viewLink=e.view_link,this.submission.editLink=e.edit_link,this.submission.message=e.message,this.submission.status=e.status,this.scrollIntoView()):e.errors?Voxel.alert(e.errors.join("<br>"),"error"):Voxel.alert(e.message||Voxel_Config.l10n.ajaxError,"error")})}},saveDraft(){this.submit({save_as_draft:!0})},toggleRow(e){e.target.closest(".ts-field-repeater").classList.toggle("collapsed")},replace_vars(t,i){return Object.keys(i).forEach(e=>{t=t.replaceAll(e,i[e])}),t},get_error(e){return this.config.validation_errors[e]},validate_field(e){e=this.$refs["field:"+e];"function"==typeof e?.validate?e.validate(e.field.value):console.warn("No validation added for this field type")},shouldValidate(e){return"create-post"===this.$root.widget&&!p.is_admin_mode},shouldValidateRequired(e){return this.validateRequired},currencyFormat(){return Voxel.helpers.currencyFormat(...arguments)},randomId(){return Math.ceil(1e5*Math.random())+"-"+Voxel.helpers.sequentialId()}},computed:{currentStep(){return this.fields[this.activeSteps[this.step_index]]},activeSteps(){return this.steps.filter(e=>this.conditionsPass(this.fields[e]))}}})).mixin(A),i.component("form-popup",Voxel.components.popup),i.component("form-group",Voxel.components.formGroup),i.component("media-popup",a),i.component("term-list",y),i.component("field-title",r),i.component("field-text",l),i.component("field-texteditor",o),i.component("field-description",d),i.component("field-number",n),i.component("field-email",h),i.component("field-url",u),i.component("field-file",c),i.component("field-image",c),i.component("field-profile-avatar",c),i.component("field-profile-name",l),i.component("field-taxonomy",b),i.component("field-phone",f),i.component("field-switcher",m),i.component("field-location",v),i.component("field-work-hours",g),i.component("field-product",O),i.component("field-ui-image",V),i.component("field-ui-heading",D),i.component("field-ui-html",S),i.component("field-repeater",F),i.component("field-timezone",T),i.component("field-recurring-date",E),i.component("field-date",q),i.component("field-select",C),i.component("field-color",L),i.component("field-post-relation",P),i.component("draggable","object"==typeof vuedraggable?vuedraggable:{}),i.component("file-upload",R),i.component("inline-template",{template:"<slot></slot>"}),i.component("single-date-input",{template:'<div><input type="hidden" ref="input"></div>',props:["modelValue","minDate"],emits:["update:modelValue"],data(){return{picker:null}},mounted(){this.picker=new Pikaday({field:this.$refs.input,container:this.$el,bound:!1,firstDay:1,keyboardInput:!1,defaultDate:this.modelValue?new Date(this.modelValue):null,onSelect:e=>{this.$emit("update:modelValue",Voxel.helpers.dateFormatYmd(e))},selectDayFn:e=>this.modelValue&&this.modelValue===Voxel.helpers.dateFormatYmd(e),disableDayFn:e=>{if(this.minDate&&e<this.minDate)return!0}})},unmounted(){setTimeout(()=>this.picker.destroy(),200)},watch:{modelValue(){this.picker.draw()}}}),i.component("date-range-input",{template:'<div class="ts-booking-date ts-booking-date-range"><input type="hidden" ref="input"></div>',props:["modelValue","minDate","startDate","endDate"],emits:["update:modelValue"],data(){return{picker:null,activePicker:"start",value:{start:this.startDate||null,end:this.endDate||null}}},mounted(){this.picker=new Pikaday({field:this.$refs.input,container:this.$el,bound:!1,firstDay:1,keyboardInput:!1,numberOfMonths:2,defaultDate:this.value.start,startRange:this.value.start,endRange:this.value.end,theme:"pika-range",onSelect:e=>{"start"===this.activePicker?(this.setStartDate(e),this.activePicker="end"):(this.setEndDate(e),this.activePicker="start",this.$emit("update:modelValue",{start:Voxel.helpers.dateFormatYmd(this.value.start),end:Voxel.helpers.dateFormatYmd(this.value.end)}))},selectDayFn:e=>!(!this.value.start||e.toDateString()!==this.value.start.toDateString())||!(!this.value.end||e.toDateString()!==this.value.end.toDateString())||void 0,disableDayFn:e=>!!("end"===this.activePicker&&this.value.start&&e<this.value.start)||!!(this.minDate&&e<this.minDate)||void 0}),this.setStartDate(this.value.start),this.setEndDate(this.value.end)},unmounted(){setTimeout(()=>this.picker.destroy(),200)},methods:{setStartDate(e){this.value.start=e,this.picker.setStartRange(e),this.value.end&&this.value.start>this.value.end&&this.setEndDate(null)},setEndDate(e){this.value.end=e,this.picker.setEndRange(e)}},watch:{activePicker(){this.picker.draw()},value:{handler(){this.picker.draw()},deep:!0}}}),document.dispatchEvent(new CustomEvent("voxel/create-post/init",{detail:{app:i,config:t,el:e}})),i.mount(e))})},window.render_create_post(),jQuery(document).on("voxel:markup-update",window.render_create_post)});
